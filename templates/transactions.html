{% extends "base.html" %}
{% block content %}
<h1>Transactions</h1>

<form method="get" class="filters card section-card">
  <div class="field">
    <label>Start Month</label>
    <select name="start_month">
      <option value="">Any</option>
      {% for m in months %}
        <option value="{{ m['month'] }}" {% if start_month == m['month'] %}selected{% endif %}>
          {{ m['month'] }}
        </option>
      {% endfor %}
    </select>
  </div>

  <div class="field">
    <label>End Month</label>
    <select name="end_month">
      <option value="">Any</option>
      {% for m in months %}
        <option value="{{ m['month'] }}" {% if end_month == m['month'] %}selected{% endif %}>
          {{ m['month'] }}
        </option>
      {% endfor %}
    </select>
  </div>

  <div class="field">
    <label>Category</label>
    <select name="category">
      <option value="">All</option>
      {% for c in categories %}
        <option value="{{ c['category'] }}" {% if selected_category == c['category'] %}selected{% endif %}>
          {{ c['category'] }}
        </option>
      {% endfor %}
    </select>
  </div>

  <div class="field">
    <label>Customer ID</label>
    <input name="customer" value="{{ search_customer }}" placeholder="e.g. 15">
  </div>

  <div class="field">
    <label>Limit</label>
    <input name="limit" value="{{ limit }}">
  </div>

  <div class="field" style="min-width:120px;">
    <label>&nbsp;</label>
    <button type="submit">Apply</button>
  </div>
</form>

<div class="table-wrap">
  <table>
    <thead>
      <tr>
        <th>ID</th><th>Date</th><th>Time</th><th>Customer</th><th>Gender</th><th>Age</th>
        <th>Category</th><th>Qty</th><th>Unit Price</th><th>COGS</th><th>Total</th>
      </tr>
    </thead>
    <tbody>
      {% for r in rows %}
      <tr>
        <td>{{ r["transactions_id"] }}</td>
        <td>{{ r["sale_date"] }}</td>
        <td>{{ r["sale_time"] }}</td>
        <td>{{ r["customer_id"] }}</td>
        <td>{{ r["gender"] }}</td>
        <td>{{ r["age"] }}</td>
        <td>{{ r["category"] }}</td>
        <td>{{ r["quantity"] }}</td>
        <td>{{ r["price_per_unit"] }}</td>
        <td>{{ r["cogs"] }}</td>
        <td>{{ r["total_sale"] }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<div class="footer-note">
  Tip: Select a Start Month and End Month to filter a monthly range using the database.
</div>
{% endblock %}
